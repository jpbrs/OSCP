# Linux Privilege Escalation

## The Basics

**SUIDS** : setuid Bit. Quando setados, os arquivos serão executados com os privilégios do dono do Arquivo.
**GUIDS** : groupuid Bit. Quando setados, os arquivos serão executados com os privilégios do grupo dono do Arquivo.


`$ ls -la`

```-rw-r--r-- 1 kali kali 45056 Aug  2 14:41 CherryTreeTemplate.ctb~~
drwxr-xr-x 5 kali kali  4096 Jul 20 12:50 Exploits```

Sendo o primeiro caractere indicando se é um arquivo(-) ou diretório (d). E os caracteres sequintes sendo as permissões de read, write e execution em :

| Posição | Função |
| 1-3 | Owner |
| 4-6 | Group |
| 7-9 | Others |

Algumas maneiras muito boas de se criar um rootshell : 

1. Copiando com algum arquivo sendo executado em sudo o /bin/bash como "rootbash" para /var/tmp. Assim, podemos utilizar `./rootbash -p` para executar o shell com os privilégios de root. 
2. Explorando vulnerabilidades com binários podendo ser executados com permissões de root. Podemos ver isso com `sudo -l` ou buscando por SUIDS and GUIDS.
3. Fazendo um Reverse Shell a partir de algum programa que é executado em root e temos permissões de escrita.

Ps : Geralmente 1 e 3 funcionam muito bem com o **chron**. Podemos executar o **pspy** para saber quais os arquivos o chron está executando em segundo plano.

## Tools

### Linux Smart Enumeration

Linux Smart Enumeration (lse.sh) pode ser executado em bash script ou python. 

Fonte : [Github Repo](https://github.com/diego-treitos/linux-smart-enumeration).

```./lse.sh -l 1```

### LinEnum

Fonte : [Github Repo](https://github.com/rebootuser/LinEnum).

## Kernel Exploits

Kernel exploits geralmente são simples de serem utilizados. Basta verificarmos a versão do Kernel com ```uname -a``` e procurarmos o exploit no Searchsploit, Google, Github, e principalmente no **ExploitDB**

1. Para rodar Kernel Exploits precisamos de compiladores na máquina vulnerável ou arquivos .sh
2. Kernel Exploits podem ser instáveis e causar falha no sistema. Então é recomendado utilizar estes em última instância